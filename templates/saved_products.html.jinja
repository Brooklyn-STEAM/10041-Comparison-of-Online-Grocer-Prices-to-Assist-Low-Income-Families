<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Leftovers - CheapCarts</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="icon" href="/static/other_images/CheapCartsLogo.png">
    <link rel="stylesheet" href="/static/styles.css">
  </head>
  <body>
  {% include "components/navbar.html.jinja" %}

    <a href="/products" class="back-products fs-5 btn m-2 text-black">
        <svg viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" width="20" height="20">
            <path d="M1.5 7.5l4-4m-4 4l4 4m-4-4H14" stroke="currentColor"></path>
        </svg> Back to Products
    </a>
    
   
    <button class="float-end m-2 btn btn-danger" type="button" id="save-clear" data-bs-toggle="modal" data-bs-target="#clearItemsModal">
        <span class="clear-label">Clear All</span>
        <span class="clear-icon">
            <svg viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" width="22" height="22"><path d="M1.5 1.5l12 12m-12 0l12-12" stroke="currentColor"></path></svg>
        </span>
    </button>
   

    <div class="modal fade" id="clearItemsModal" tabindex="-1" aria-labelledby="clearItemsModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5 text-danger" id="deleteAccountModalLabel">Clear Items Confirmation</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to <b>clear all</b> of the items you have saved?</p> 
                </div>
                <div class="modal-footer">
                <form action="/leftovers/clear_all" method="post">
                    <button type="button" class="btn btn-secondary d-inline float-start me-4" data-bs-dismiss="modal" aria-label="Close">Close</button>
                    <button type="submit" id="delete-btn" class="btn btn-danger">Clear All Items</button>
                </form>
                </div>
            </div>
        </div>
    </div>

    <br>

    <!-- Tutorial -->
    <button type="button" class="btn m-1 tutorial" data-bs-toggle="modal" data-bs-target="#leftoverGuideModal">
        <svg data-bs-toggle="tooltip" data-bs-placement="right" data-bs-custom-class="custom-tooltip" data-bs-title="Tutorial" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" width="30" height="30"><path d="M7.5 9V7.5H8A1.5 1.5 0 009.5 6v-.1a1.4 1.4 0 00-1.4-1.4h-.6A1.5 1.5 0 006 6m1 4.5h1m-.5 4a7 7 0 110-14 7 7 0 010 14z" stroke="currentColor"></path></svg>
  </button>

  <!-- Modal -->
  <div class="modal fade" id="leftoverGuideModal" tabindex="-1" aria-labelledby="leftoverGuideModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-4" id="leftoverGuideModalLabel">Guide to Leftovers</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body fs-5">
            <h3>Welcome!</h3>
            <p>These are your Leftovers, it contains all of the items you saved. </p>
            <p>In order to save an item, just click on the red heart button seen on the product card (when on the <a href="/products" class="guide-link text-Cambridge link-underline link-underline-opacity-0">Products</a> page) or underneath the product name (when on a product's individual page).</p>

            <p class="fw-bold">The Save button looks like this:</p>
            <button class="save-btn btn btn-danger mb-2 mt-1">
            <span class="save-label me-1">Save </span>
            <span class="save-heart"> <svg viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" width="20" height="20">
              <path
                d="M7.5 13.5l-.354.354a.5.5 0 00.708 0L7.5 13.5zM1.536 7.536l-.354.353.354-.353zm5-5l-.354.353.354-.353zM7.5 3.5l-.354.354a.5.5 0 00.708 0L7.5 3.5zm.964-.964l-.353-.354.353.354zm-.61 10.61L1.889 7.182l-.707.707 5.964 5.965.708-.708zm5.257-5.964l-5.965 5.964.708.708 5.964-5.965-.707-.707zM6.182 2.889l.964.965.708-.708-.965-.964-.707.707zm1.672.965l.964-.965-.707-.707-.965.964.708.708zM10.964 1c-1.07 0-2.096.425-2.853 1.182l.707.707A3.037 3.037 0 0110.964 2V1zM14 5.036c0 .805-.32 1.577-.89 2.146l.708.707A4.036 4.036 0 0015 5.036h-1zm1 0A4.036 4.036 0 0010.964 1v1A3.036 3.036 0 0114 5.036h1zM4.036 2c.805 0 1.577.32 2.146.89l.707-.708A4.036 4.036 0 004.036 1v1zM1 5.036A3.036 3.036 0 014.036 2V1A4.036 4.036 0 000 5.036h1zm.89 2.146A3.035 3.035 0 011 5.036H0c0 1.07.425 2.096 1.182 2.853l.707-.707z" fill="currentColor"></path>
              </svg></span>
            </button>

            <p class="mt-2">You can search through items in your Leftovers by using the search bar above the items.</p> 
            
            <p>Items can be removed from your Leftovers by clicking the red trash button in the button right corner of the product card. Items can also be removed by clicking the "Saved" button that replaces the "Save" button when an item is saved.</p>

            <p>If you want to get rid of all of the items in your Leftovers, click the red "X" button in the top right corner of the page. A pop up will appear asking if you are sure you want to clear all of your items. If you want to clear all of your items, click the red "Clear All Items" button.</p>

            <hr class="invisible">

            <p class="fw-bold">For more information, see our <a href="/guide" class="guide-link text-Cambridge link-underline link-underline-opacity-0">Guide</a>!</p>
          
          
        </div>
        <div class="modal-footer">
            <a href="/guide" class="btn secondaryColor">Go to Guide</a>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

    <main class="container" id="saved-main">

    <header id="saved-header">
        <h1 class="text-center">Leftovers</h1>
        <h2 class="text-center">View your saved products here!</h2>

        <form id="saved-search" action="/leftovers" class="d-flex my-3 mb-4" role="search">
            <input class="text-box form-control me-2" type="search" name="query" placeholder="Search" aria-label="Search" value="{{request.args.get('query', '')}}">
            <button id="product-search" class="btn secondaryColor" type="submit">Search</button>
        </form>
    </header>

    <div id="saved-rule"></div>

    
    <div id="leftovers-section" class="overflow-auto me-2">
        {%if products |length > 0%}
        {%for item in products | sort(attribute='item_name')%}
        <a href="/savecompare/{{item['id']}}" class="mb-2 saved-card card text-black link-underline link-underline-opacity-0 flex-row">
            <div class="col-md-3">
                <img src="{{item['item_image']}}" class="mh-100 rounded-start" width="100px" alt="Image of {{item['item_name']}}">
            </div>
            <div class="col-md-9">
                <div class="card-body ps-1">
                    <h3 class="card-title">{{item['item_name']}}</h3>

                    <form class="float-end mb-2" action="/leftovers/{{item['id']}}/unsave" method="post">
                        <button type="submit" class="btn btn-danger unsave-trash-btn">
                        <span class="trash-label me-1">Unsave</span>
                             <span class="unsave-can"><svg viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" width="19" height="19"><path d="M4.5 3V1.5a1 1 0 011-1h4a1 1 0 011 1V3M0 3.5h15m-13.5 0v10a1 1 0 001 1h10a1 1 0 001-1v-10M7.5 7v5m-3-3v3m6-3v3" stroke="currentColor"></path></svg></span>
                        </button>
                    </form>
                </div>
            </div>
        </a>
    
    {%endfor%}
    {%elif request.args.get('query') != None%}
    <h1 class="text-center">'{{request.args.get('query')}}' Not Found</h1>

    {%else%}
    <div class="text-center mt-4">
        <h1 class="text-center mt-3 text-White">You Have No Items Saved</h1>
        <a href="/products" class="back-products fs-3 btn btn-lg mx-auto mt-3">
             Go to Products
        </a>
    </div>
    {%endif%}
    </div>
    </main>

    {% include "components/footer.html.jinja"%}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script>
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
    const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
  </script>
  </body>
</html>